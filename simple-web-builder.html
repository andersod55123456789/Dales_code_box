<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Web Builder - DaleBuilds.org</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            height: 100vh;
            overflow: hidden;
        }

        .builder-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 300px;
            background: white;
            border-right: 2px solid #e0e0e0;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 24px;
        }

        .elements-section {
            margin-bottom: 30px;
        }

        .elements-section h3 {
            color: #666;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .draggable-element {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: grab;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s ease;
            user-select: none;
        }

        .draggable-element:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .draggable-element:active {
            cursor: grabbing;
            transform: translateY(0);
        }

        .canvas-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .canvas {
            background: white;
            min-height: 600px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 20px;
            position: relative;
        }

        .canvas.drag-over {
            border: 3px dashed #667eea;
            background: #f8f9ff;
        }

        .canvas-element {
            margin-bottom: 20px;
            position: relative;
            cursor: pointer;
            border: 2px solid transparent;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.2s ease;
        }

        .canvas-element:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .canvas-element.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .canvas-text {
            font-size: 16px;
            line-height: 1.5;
            color: #333;
            min-height: 24px;
        }

        .canvas-text[contenteditable="true"] {
            outline: none;
            background: #fff;
            border: 1px solid #667eea;
            border-radius: 3px;
        }

        .canvas-image {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
        }

        .placeholder-image {
            width: 200px;
            height: 150px;
            background: #f0f0f0;
            border: 2px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            border-radius: 5px;
            cursor: pointer;
        }

        .size-slider {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            width: 200px;
        }

        .size-slider input {
            width: 100%;
            margin-top: 5px;
        }

        .controls {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #36d1dc 0%, #5b86e5 100%);
        }

        .preview-mode {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            overflow-y: auto;
            display: none;
        }

        .preview-header {
            background: #333;
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: between;
            align-items: center;
        }

        .preview-content {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .code-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .code-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80%;
            overflow-y: auto;
        }

        .code-content textarea {
            width: 100%;
            height: 300px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            resize: vertical;
        }

        .empty-canvas {
            color: #999;
            text-align: center;
            padding: 60px 20px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="builder-container">
        <div class="sidebar">
            <h2>DaleBuilds Web Builder</h2>
            
            <div class="elements-section">
                <h3>Drag Elements</h3>
                <div class="draggable-element" draggable="true" data-type="text">
                    üìù Text Block
                </div>
                <div class="draggable-element" draggable="true" data-type="image">
                    üñºÔ∏è Image
                </div>
            </div>

            <div class="controls">
                <button class="btn" onclick="previewSite()">üëÅÔ∏è Preview</button>
                <button class="btn secondary" onclick="exportHTML()">üìÑ Get HTML</button>
                <button class="btn" onclick="clearCanvas()" style="background: #e74c3c;">üóëÔ∏è Clear All</button>
            </div>
        </div>

        <div class="canvas-container">
            <div class="canvas" id="canvas">
                <div class="empty-canvas">
                    Drag elements from the left to start building your website!
                </div>
            </div>
        </div>
    </div>

    <div class="preview-mode" id="previewMode">
        <div class="preview-header">
            <h2>Website Preview</h2>
            <button class="btn" onclick="closePreview()">‚Üê Back to Editor</button>
        </div>
        <div class="preview-content" id="previewContent"></div>
    </div>

    <div class="code-modal" id="codeModal">
        <div class="code-content">
            <h3>Your Website HTML Code</h3>
            <p>Copy the code below and save it as an HTML file:</p>
            <textarea id="htmlCode" readonly></textarea>
            <div style="margin-top: 20px;">
                <button class="btn" onclick="copyCode()">üìã Copy Code</button>
                <button class="btn secondary" onclick="closeCodeModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        let draggedElement = null;
        let selectedElement = null;
        let currentSlider = null;

        // Drag and drop functionality
        document.querySelectorAll('.draggable-element').forEach(element => {
            element.addEventListener('dragstart', function(e) {
                draggedElement = this;
                e.dataTransfer.effectAllowed = 'copy';
            });
        });

        const canvas = document.getElementById('canvas');

        canvas.addEventListener('dragover', function(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
            this.classList.add('drag-over');
        });

        canvas.addEventListener('dragleave', function(e) {
            this.classList.remove('drag-over');
        });

        canvas.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('drag-over');

            if (draggedElement) {
                const elementType = draggedElement.dataset.type;
                createElement(elementType);
                draggedElement = null;
            }
        });

        function createElement(type) {
            const emptyMessage = canvas.querySelector('.empty-canvas');
            if (emptyMessage) {
                emptyMessage.remove();
            }

            const element = document.createElement('div');
            element.className = 'canvas-element';
            element.dataset.type = type;

            if (type === 'text') {
                element.innerHTML = '<div class="canvas-text" data-size="16">Click to edit this text</div>';
            } else if (type === 'image') {
                element.innerHTML = '<div class="placeholder-image" data-size="200">Click to add image</div>';
            }

            canvas.appendChild(element);
            setupElementEvents(element);
        }

        function setupElementEvents(element) {
            element.addEventListener('click', function(e) {
                e.stopPropagation();
                selectElement(this);

                if (this.dataset.type === 'text') {
                    const textDiv = this.querySelector('.canvas-text');
                    if (textDiv.textContent === 'Click to edit this text') {
                        textDiv.textContent = '';
                    }
                    textDiv.contentEditable = true;
                    textDiv.focus();
                } else if (this.dataset.type === 'image') {
                    const placeholder = this.querySelector('.placeholder-image');
                    if (placeholder) {
                        addImage(this);
                    }
                }
            });

            // Handle text editing
            const textDiv = element.querySelector('.canvas-text');
            if (textDiv) {
                textDiv.addEventListener('blur', function() {
                    this.contentEditable = false;
                    if (this.textContent.trim() === '') {
                        this.textContent = 'Click to edit this text';
                    }
                });

                textDiv.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.blur();
                    }
                });
            }
        }

        function selectElement(element) {
            // Remove previous selection
            document.querySelectorAll('.canvas-element.selected').forEach(el => {
                el.classList.remove('selected');
            });

            // Hide any open slider
            hideSlider();

            element.classList.add('selected');
            selectedElement = element;

            // Show size slider
            showSizeSlider(element);
        }

        function showSizeSlider(element) {
            const slider = document.createElement('div');
            slider.className = 'size-slider';
            slider.innerHTML = `
                <label>Size:</label>
                <input type="range" id="sizeRange" min="10" max="100" value="${getCurrentSize(element)}">
                <span id="sizeValue">${getCurrentSize(element)}</span>
            `;

            const rect = element.getBoundingClientRect();
            slider.style.position = 'absolute';
            slider.style.top = (rect.bottom + window.scrollY + 10) + 'px';
            slider.style.left = rect.left + 'px';

            document.body.appendChild(slider);
            currentSlider = slider;

            const range = slider.querySelector('#sizeRange');
            const valueSpan = slider.querySelector('#sizeValue');

            range.addEventListener('input', function() {
                const value = this.value;
                valueSpan.textContent = value;
                updateElementSize(element, value);
            });
        }

        function getCurrentSize(element) {
            if (element.dataset.type === 'text') {
                const textDiv = element.querySelector('.canvas-text');
                return textDiv.dataset.size || 16;
            } else if (element.dataset.type === 'image') {
                const img = element.querySelector('.canvas-image');
                if (img) {
                    return Math.round((img.style.width ? parseInt(img.style.width) : img.offsetWidth) / 10);
                } else {
                    const placeholder = element.querySelector('.placeholder-image');
                    return placeholder.dataset.size / 10;
                }
            }
            return 50;
        }

        function updateElementSize(element, size) {
            if (element.dataset.type === 'text') {
                const textDiv = element.querySelector('.canvas-text');
                textDiv.style.fontSize = size + 'px';
                textDiv.dataset.size = size;
            } else if (element.dataset.type === 'image') {
                const img = element.querySelector('.canvas-image');
                if (img) {
                    img.style.width = (size * 10) + 'px';
                } else {
                    const placeholder = element.querySelector('.placeholder-image');
                    placeholder.style.width = (size * 10) + 'px';
                    placeholder.dataset.size = size * 10;
                }
            }
        }

        function hideSlider() {
            if (currentSlider) {
                currentSlider.remove();
                currentSlider = null;
            }
        }

        // Click outside to deselect
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.canvas-element') && !e.target.closest('.size-slider')) {
                document.querySelectorAll('.canvas-element.selected').forEach(el => {
                    el.classList.remove('selected');
                });
                selectedElement = null;
                hideSlider();
            }
        });

        function addImage(element) {
            const choice = confirm("Choose image source:\nOK = Upload file\nCancel = Enter URL");
            
            if (choice) {
                // File upload
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            replaceWithImage(element, e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            } else {
                // URL input
                const url = prompt("Enter image URL:");
                if (url && url.trim()) {
                    replaceWithImage(element, url.trim());
                }
            }
        }

        function replaceWithImage(element, src) {
            const currentSize = element.querySelector('.placeholder-image').dataset.size || 200;
            element.innerHTML = `<img class="canvas-image" src="${src}" style="width: ${currentSize}px;" alt="User image">`;
        }

        function previewSite() {
            const previewContent = document.getElementById('previewContent');
            const previewMode = document.getElementById('previewMode');
            
            let html = '';
            const elements = canvas.querySelectorAll('.canvas-element');
            
            elements.forEach(element => {
                if (element.dataset.type === 'text') {
                    const textDiv = element.querySelector('.canvas-text');
                    const fontSize = textDiv.dataset.size || 16;
                    html += `<p style="font-size: ${fontSize}px; line-height: 1.5; margin-bottom: 20px;">${textDiv.textContent}</p>`;
                } else if (element.dataset.type === 'image') {
                    const img = element.querySelector('.canvas-image');
                    if (img) {
                        const width = img.style.width || '200px';
                        html += `<img src="${img.src}" style="width: ${width}; height: auto; margin-bottom: 20px; border-radius: 5px;" alt="Image">`;
                    }
                }
            });

            if (!html) {
                html = '<p style="text-align: center; color: #999;">Your website is empty. Add some elements first!</p>';
            }

            previewContent.innerHTML = html;
            previewMode.style.display = 'block';
        }

        function closePreview() {
            document.getElementById('previewMode').style.display = 'none';
        }

        function exportHTML() {
            const elements = canvas.querySelectorAll('.canvas-element');
            
            let bodyContent = '';
            elements.forEach(element => {
                if (element.dataset.type === 'text') {
                    const textDiv = element.querySelector('.canvas-text');
                    const fontSize = textDiv.dataset.size || 16;
                    bodyContent += `    <p style="font-size: ${fontSize}px; line-height: 1.5; margin-bottom: 20px;">${textDiv.textContent}</p>\n`;
                } else if (element.dataset.type === 'image') {
                    const img = element.querySelector('.canvas-image');
                    if (img) {
                        const width = img.style.width || '200px';
                        bodyContent += `    <img src="${img.src}" style="width: ${width}; height: auto; margin-bottom: 20px; border-radius: 5px;" alt="Image">\n`;
                    }
                }
            });

            if (!bodyContent) {
                alert('Your website is empty! Add some elements first.');
                return;
            }

            const fullHTML = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Website - Built with DaleBuilds</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
    </style>
</head>
<body>
${bodyContent}
</body>
</html>`;

            document.getElementById('htmlCode').value = fullHTML;
            document.getElementById('codeModal').style.display = 'flex';
        }

        function copyCode() {
            const textarea = document.getElementById('htmlCode');
            textarea.select();
            document.execCommand('copy');
            alert('HTML code copied to clipboard!');
        }

        function closeCodeModal() {
            document.getElementById('codeModal').style.display = 'none';
        }

        function clearCanvas() {
            if (confirm('Are you sure you want to clear all elements?')) {
                canvas.innerHTML = '<div class="empty-canvas">Drag elements from the left to start building your website!</div>';
                hideSlider();
                selectedElement = null;
            }
        }
    </script>
</body>
</html>